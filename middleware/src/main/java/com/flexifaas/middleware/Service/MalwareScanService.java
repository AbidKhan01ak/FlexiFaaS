package com.flexifaas.middleware.Service;

import com.flexifaas.middleware.Dto.MalwareScanResponse;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;


@Service
public class MalwareScanService {
    public MalwareScanResponse scanFile(MultipartFile file) {
        // MOCK: Mark .exe, .bat, .vbs as malware, rest as clean
        String name = file.getOriginalFilename();
        boolean isMalware = false;
        if (name != null && (
                name.endsWith(".exe") ||
                        name.endsWith(".bat") ||
                        name.endsWith(".vbs") ||
                        name.toLowerCase().contains("virus")
        )) {
            isMalware = true;
        }
        String result = isMalware ? "Malicious file detected" : "No malware found";
        return new MalwareScanResponse(!isMalware, result);
    }
}
